<!DOCTYPE html>
<html>

<head>
    <title>ByteSorcerer | Malware Attributor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Lilita+One&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Caveat+Brush&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Annie+Use+Your+Telescope&display=swap" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='styles/style.css')}}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="icon" type="image/x-icon" href="{{url_for('static',filename='images/logo.ico')}}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div class="container-fluid">
        <div class="row" style="height: 100vh">
            <div class="col-lg-6 search-container">
                <div>
                    <img src="{{url_for('static',filename='images/logo.png')}}" alt="logo">
                    <h1>Malware Attributor</h1>
                    <p>Malware Identification Powered by Machine Learning.</p>
                    <div class="selector-container">
                        <div id="outerContainer">
                            <div id="buttonContainer">
                                <div class="redButton"></div>
                            </div>
                            <div id="legendTextContainer">
                                <div class="legendText" onclick="option_static(this)" style="color: white;">Static</div>
                                <div class="legendText" onclick="option_traits(this)">Traits</div>
                                <div class="legendText" onclick="option_cfg(this)">CFGs</div>
                            </div>
                        </div>
                        <div class="tool-tip">
                            <i class="fa fa-question-circle"></i>
                            <span class="tooltiptext">
                                <p><b>Static: </b>Extracts static features from a PE file. Extracted features are fed
                                    into a machine learning model to identify the malware family.</p>
                                <p><b>Traits: </b>Utilizes Binlex to extract traits from a PE file. Trait matching is
                                    employed to identify the family of the malware. Only works on a limited number of
                                    malware families for now. (15 families)</p>
                                <p><b>CFGs: </b>Extracts control flow graphs from a PE file. Traces are generated from
                                    the CFGs and fed into a machine learning model to identify the malware family.</p>
                            </span>
                        </div>
                    </div>
                    <div class="version-selector-container">
                        <div id="version-outerContainer">
                            <div id="version-buttonContainer">
                                <div class="version-redButton"></div>
                            </div>
                            <div id="version-legendTextContainer">
                                <div class="version-legendText" onclick="model_lite_option(this)" style="color: white;">Lite
                                </div>
                                <div class="version-legendText" onclick="model_full_option(this)">Full</div>
                            </div>
                        </div>
                        <div id="version-outerContainer-traits">
                            <div id="version-buttonContainer-traits">
                                <div class="version-redButton-traits"></div>
                            </div>
                            <div id="version-legendTextContainer-traits">
                                <div class="version-legendText-traits" onclick="traits_partial_option(this)" style="color: white;">Partial
                                </div>
                                <div class="version-legendText-traits" onclick="traits_full_option(this)">Full</div>
                            </div>
                        </div>
                        <div class="tool-tip">
                            <i class="fa fa-question-circle"></i>
                            <span class="tooltiptext-v">
                                <p><b>Lite: </b>The model is trained on a smaller dataset, which results in faster and
                                    more accurate analysis but works on a limited number of malware families. (15
                                    families)</p>
                                <p><b>Full: </b>The model is trained on a larger dataset, works on a wider range of
                                    malware families but might be slower and less accurate. (86 families)</p>
                            </span>
                            <span class="tooltiptext-v" style="display: none;">
                                <p><b>Partial: </b>Extracts and uses only the top most common occurring traits to perform the analysis, this
                                    will result in faster analysis but with less accuracy.</p>
                                <p><b>Full: </b>Extracts and uses all the unique traits from the PE file to perform the
                                    analysis, this will result in slower analysis but with more accuracy.</p>
                        </div>
                    </div>
                    <form id="upload-form">
                        <input type=file name=file id="file-uploader" required>
                        <p id="message">Maximum file size: 100MB</p>
                        <input type="submit" value="Upload & Analyze" id="submit_btn" disabled>
                        <input type="hidden" name="model_type" id="model_type" value="lite">
                        <input type="hidden" name="method_type" id="method_type" value="partial">
                    </form>
                </div>
            </div>
            <div class="col-lg-6 result-container">
                <div class="result-board">
                    <div id="fader">
                        <div class="display-name" id="results-div">
                            <h1 style="font-family: Lilita One;">Analysis Results</h1>
                            <span id="result" style="font-size: 18px;">-</span>
                        </div>
                        <div id="error">
                            <img src="{{url_for('static',filename='images/error.png')}}" alt="error" width="100px">
                            <h1 style="font-family: Lilita One;">Unable to Analyze</h1>
                            <span id="error-msg">-</span>
                        </div>
                    </div>
                </div>
                <div id="loader">
                    <div class="lds-grid">
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                    <h5 id="status">Analyzing . . .</h5>
                </div>
                <div id="init">
                    <h1 style="font-family: Lilita One;">To get started,</h1>
                    <span style="color: grey;">
                        Upload a Portable Executable (PE) file to begin analysis.
                        <br><br>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <script src="{{url_for('static',filename='scripts/main.js')}}"></script>
</body>

</html>